extends layout

block content
    h1= title
    p: a(href='/history') history
    div#event-list

        form.form-inline(method='post', action='/events')
            fieldset
                input.input-small(name='name', type='text', placeholder='Name')
                input.input-small(name='subname', type='text', placeholder='Subname')
                button.btn.btn-primary(type='submit') Create

        table.table
            each item in events
                tr
                        td
                            //- Either display "parent:child" or just "parent"
                            - var fullName = item.subname ? item.name + ":" + item.subname : item.name
                            - var subname = item.subname ?  item.subname : "";
                            a.event.pseudo-form.pseudo-submit(
                                href='#',
                                data-formid=fullName,
                                data-action='/history',
                                data-method='post') #{fullName}

                            input.pseudo-form(
                                data-formid=fullName,
                                type='hidden',
                                name='name',
                                value=item.name)

                            input.pseudo-form(
                                data-formid=fullName,
                                type='hidden',
                                name='subname',
                                value=subname)
                        td
                            input.pseudo-form(
                                data-formid=fullName,
                                name='offset',
                                type='text',
                                placeholder='0')
                            select.pseudo-form(name='offsetunits', data-formid=fullName)
                                option(value='seconds') seconds
                                option(value='minutes') minutes
                                option(value='hours') hours
                                option(value='days') days
                        td
                            a.event-delete(
                                href='#',
                                data-name=item.name,
                                data-subname=item.subname,
                                data-fullName=fullName) DELETE
