extends layout

block content
    h1 
        a(href='/visualize') visualize
        /
        a(href='/visualize/stack') stack

    p: a(href='/events') events
    div#visualize-stack
        - var prevDateString = ""
        div.left-column(style="float:left; width:50%; display:block")
            each item in history
                - var scale;
                - if (item.duration.millis) {
                    - scale = parseInt(item.duration.millis) / (24 * 60 * 60 * 1000);
                - } else {
                    - scale = (Date.now() - item.start.millis) / (24 * 60 * 60 * 1000);
                - }
                - var scaledHeight = scale * 1000;
                - var isEmpty = item.name == 'stop' || item.name == 'not:previous'? true : false;
                    if isEmpty
                        div(data-name=item.name, style='width:100%; margin:0; margin-bottom:5px; background-color:#fff; display:block; float:left; height:' + scaledHeight + 'px')
                    else
                        div(data-name=item.name, style='width:100%; margin:0; margin-bottom:5px; background-color:#aaa; display:block; float:left; height:' + scaledHeight + 'px')

        div.right-column(style="float:left; width:48%; padding:0 1%; display:block")
            each item in history
                - var scale;
                - if (item.duration.millis) {
                    - scale = parseInt(item.duration.millis) / (24 * 60 * 60 * 1000);
                - } else {
                    - scale = (Date.now() - item.start.millis) / (24 * 60 * 60 * 1000);
                - }
                - var scaledHeight = scale * 1000;
                - var isEmpty = item.name == 'stop' || item.name == 'not:previous'? true : false;
                - var scaledFontSize = scale * 720;
                - var fontSize = Math.max(scaledFontSize, 14); // Use at least 14px font size.
                if isEmpty
                    div(data-name=item.name, style='width:100%; margin:0; margin-bottom:5px; background-color:#fff; display:block; float:left; height:' + scaledHeight + 'px')
                else
                    div(data-name=item.name, style='width:100%; margin:0; margin-bottom:5px; background-color:#fff; display:block; float:left; font-size:' + fontSize + 'px ; height:' + scaledHeight + 'px') #{item.name}
